root@6016705-wd74101:/opt/Disbalanced# docker-compose -f docker-compose.production.yml up -d --build
Building coinservice
DEPRECATED: The legacy builder is deprecated and will be removed in a future release.
            Install the buildx component to build images with BuildKit:
            https://docs.docker.com/go/buildx/

Sending build context to Docker daemon  1.754MB
Step 1/16 : FROM mcr.microsoft.com/dotnet/sdk:9.0 AS build
 ---> d6ba41c97680
Step 2/16 : WORKDIR /src
 ---> Using cache
 ---> 1d614eabb577
Step 3/16 : COPY ["CoinService/CoinService.csproj", "CoinService/"]
 ---> Using cache
 ---> 5a0adc8db969
Step 4/16 : COPY ["APIBricks.CoinAPI.MarketDataAPI.REST.V1/APIBricks.CoinAPI.MarketDataAPI.REST.V1.csproj", "APIBricks.CoinAPI.MarketDataAPI.REST.V1/"]
 ---> Using cache
 ---> eefca6e78830
Step 5/16 : RUN dotnet restore "CoinService/CoinService.csproj"
 ---> Using cache
 ---> 137ea216d0eb
Step 6/16 : COPY . .
 ---> Using cache
 ---> e7b96165dc9b
Step 7/16 : WORKDIR "/src/CoinService"
 ---> Using cache
 ---> cd72cfc924f4
Step 8/16 : RUN dotnet build "CoinService.csproj" -c Release -o /app/build
 ---> Using cache
 ---> 05b89bddfc75
Step 9/16 : FROM build AS publish
 ---> 05b89bddfc75
Step 10/16 : RUN dotnet publish "CoinService.csproj" -c Release -o /app/publish /p:UseAppHost=false
 ---> Using cache
 ---> 9bef3e462d09
Step 11/16 : FROM mcr.microsoft.com/dotnet/aspnet:9.0 AS final
 ---> 5aa31677de8f
Step 12/16 : WORKDIR /app
 ---> Using cache
 ---> b8ed19ed5566
Step 13/16 : RUN mkdir -p /app/logs
 ---> Using cache
 ---> 7fe6b49fd911
Step 14/16 : COPY --from=publish /app/publish .
 ---> Using cache
 ---> 42a73dbeff7a
Step 15/16 : EXPOSE 8080
 ---> Using cache
 ---> a52901a1fbff
Step 16/16 : ENTRYPOINT ["dotnet", "CoinService.dll"]
 ---> Using cache
 ---> 6173d8048608
Successfully built 6173d8048608
Successfully tagged disbalanced_coinservice:latest
Building frontend
DEPRECATED: The legacy builder is deprecated and will be removed in a future release.
            Install the buildx component to build images with BuildKit:
            https://docs.docker.com/go/buildx/

Sending build context to Docker daemon  22.76MB
Step 1/26 : FROM node:20-alpine AS deps
 ---> 9992b59c17bf
Step 2/26 : WORKDIR /app
 ---> Using cache
 ---> b8cf53d9925f
Step 3/26 : COPY package.json package-lock.json ./
 ---> Using cache
 ---> 0d17a4398c19
Step 4/26 : RUN npm ci --only=production=false
 ---> Using cache
 ---> 0133e930fd63
Step 5/26 : FROM node:20-alpine AS builder
 ---> 9992b59c17bf
Step 6/26 : WORKDIR /app
 ---> Using cache
 ---> b8cf53d9925f
Step 7/26 : ARG NEXT_PUBLIC_API_URL=http://localhost:5000
 ---> Using cache
 ---> e6e00acd5e49
Step 8/26 : COPY --from=deps /app/node_modules ./node_modules
 ---> Using cache
 ---> 1367d8d4c34c
Step 9/26 : COPY . .
^[[B ---> 7c2739d92f77
Step 10/26 : ENV NEXT_PUBLIC_API_URL=$NEXT_PUBLIC_API_URL
 ---> Running in c977e8f74f87
 ---> Removed intermediate container c977e8f74f87
 ---> c3272d355aeb
Step 11/26 : ENV NEXT_TELEMETRY_DISABLED=1
 ---> Running in 125831338c63
 ---> Removed intermediate container 125831338c63
 ---> ba2f2c37c7e8
Step 12/26 : RUN npm run build
 ---> Running in 8321c469fced

> disbalanced@0.1.0 build
> next build

  ▲ Next.js 14.2.15

   Creating an optimized production build ...
 ✓ Compiled successfully
   Linting and checking validity of types ...
   Collecting page data ...
   Generating static pages (0/5) ...
   Generating static pages (1/5)
   Generating static pages (2/5)
   Generating static pages (3/5)
 ✓ Generating static pages (5/5)
   Finalizing page optimization ...
   Collecting build traces ...

Route (app)                              Size     First Load JS
┌ ○ /                                    498 B          94.4 kB
├ ○ /_not-found                          873 B          88.1 kB
└ ○ /charts                              4.45 kB        91.7 kB
+ First Load JS shared by all            87.2 kB
  ├ chunks/117-786dd161cf050e2e.js       31.6 kB
  ├ chunks/fd9d1056-0016ed4352a16d7b.js  53.6 kB
  └ other shared chunks (total)          2.01 kB


○  (Static)  prerendered as static content

npm notice
npm notice New major version of npm available! 10.8.2 -> 11.7.0
npm notice Changelog: https://github.com/npm/cli/releases/tag/v11.7.0
npm notice To update run: npm install -g npm@11.7.0
npm notice
 ---> Removed intermediate container 8321c469fced
 ---> dde6936d6059
Step 13/26 : FROM node:20-alpine AS runner
 ---> 9992b59c17bf
Step 14/26 : WORKDIR /app
 ---> Using cache
 ---> b8cf53d9925f
Step 15/26 : ENV NODE_ENV=production
 ---> Using cache
 ---> 9825b5b31992
Step 16/26 : ENV NEXT_TELEMETRY_DISABLED=1
 ---> Using cache
 ---> ba86c247e359
Step 17/26 : RUN addgroup --system --gid 1001 nodejs
 ---> Using cache
 ---> e02a9f50ae72
Step 18/26 : RUN adduser --system --uid 1001 nextjs
 ---> Using cache
 ---> 49efc2f24250
Step 19/26 : COPY --from=builder /app/public ./public
 ---> Using cache
 ---> 359b6caaa488
Step 20/26 : COPY --from=builder --chown=nextjs:nodejs /app/.next/standalone ./
 ---> ab4bbb5f6f12
Step 21/26 : COPY --from=builder --chown=nextjs:nodejs /app/.next/static ./.next/static
 ---> c86078b26320
Step 22/26 : USER nextjs
 ---> Running in 79f14b889d50
 ---> Removed intermediate container 79f14b889d50
 ---> 129934ccd8e3
Step 23/26 : EXPOSE 3000
 ---> Running in faf4d3d281d4
 ---> Removed intermediate container faf4d3d281d4
 ---> d4fb54c99875
Step 24/26 : ENV PORT=3000
 ---> Running in 927e8f11af80
 ---> Removed intermediate container 927e8f11af80
 ---> e8bc9df08245
Step 25/26 : ENV HOSTNAME="0.0.0.0"
 ---> Running in 4a5f6f693e97
 ---> Removed intermediate container 4a5f6f693e97
 ---> 47e20447f583
Step 26/26 : CMD ["node", "server.js"]
 ---> Running in 21283bde89a8
 ---> Removed intermediate container 21283bde89a8
 ---> 9745f3feef17
Successfully built 9745f3feef17
Successfully tagged disbalanced_frontend:latest
Recreating coinservice_postgres ...

ERROR: for coinservice_postgres  'ContainerConfig'

ERROR: for postgres  'ContainerConfig'
Traceback (most recent call last):
  File "/usr/bin/docker-compose", line 33, in <module>
    sys.exit(load_entry_point('docker-compose==1.29.2', 'console_scripts', 'docker-compose')())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3/dist-packages/compose/cli/main.py", line 81, in main
    command_func()
  File "/usr/lib/python3/dist-packages/compose/cli/main.py", line 203, in perform_command
    handler(command, command_options)
  File "/usr/lib/python3/dist-packages/compose/metrics/decorator.py", line 18, in wrapper
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3/dist-packages/compose/cli/main.py", line 1186, in up
    to_attach = up(False)
                ^^^^^^^^^
  File "/usr/lib/python3/dist-packages/compose/cli/main.py", line 1166, in up
    return self.project.up(
           ^^^^^^^^^^^^^^^^
  File "/usr/lib/python3/dist-packages/compose/project.py", line 697, in up
    results, errors = parallel.parallel_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3/dist-packages/compose/parallel.py", line 108, in parallel_execute
    raise error_to_reraise
  File "/usr/lib/python3/dist-packages/compose/parallel.py", line 206, in producer
    result = func(obj)
             ^^^^^^^^^
  File "/usr/lib/python3/dist-packages/compose/project.py", line 679, in do
    return service.execute_convergence_plan(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3/dist-packages/compose/service.py", line 579, in execute_convergence_plan
    return self._execute_convergence_recreate(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3/dist-packages/compose/service.py", line 499, in _execute_convergence_recreate
    containers, errors = parallel_execute(
                         ^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3/dist-packages/compose/parallel.py", line 108, in parallel_execute
    raise error_to_reraise
  File "/usr/lib/python3/dist-packages/compose/parallel.py", line 206, in producer
    result = func(obj)
             ^^^^^^^^^
  File "/usr/lib/python3/dist-packages/compose/service.py", line 494, in recreate
    return self.recreate_container(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3/dist-packages/compose/service.py", line 612, in recreate_container
    new_container = self.create_container(
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3/dist-packages/compose/service.py", line 330, in create_container
    container_options = self._get_container_create_options(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3/dist-packages/compose/service.py", line 921, in _get_container_create_options
    container_options, override_options = self._build_container_volume_options(
                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3/dist-packages/compose/service.py", line 960, in _build_container_volume_options
    binds, affinity = merge_volume_bindings(
                      ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3/dist-packages/compose/service.py", line 1548, in merge_volume_bindings
    old_volumes, old_mounts = get_container_data_volumes(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3/dist-packages/compose/service.py", line 1579, in get_container_data_volumes
    container.image_config['ContainerConfig'].get('Volumes') or {}
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
KeyError: 'ContainerConfig'
root@6016705-wd74101:/opt/Disbalanced#